<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: LDAP MultiDomain Utilities: Search Computer

## Function - LDAP MultiDomain Utilities: Search

### API Name
`ldap_md_utilities_search`

### Output Name
`None`

### Message Destination
`fn_ldap_md_utilities`

### Pre-Processing Script
```python
##  LDAP Utilities: Search - pre-processing script ##
inputs.ldap_md_domain_name = 'domain1'
inputs.ldap_md_search_base = "dc=example,dc=com"
inputs.ldap_md_search_filter = "(&(objectClass=computer)(cn=*%ldap_param%))"
inputs.ldap_md_search_attributes = "cn,operatingSystem,operatingSystemVersion,operatingSystemServicePack,userAccountControl,whenCreated,distinguishedName,pwdLastSet"
inputs.ldap_md_search_param = artifact.value
```

### Post-Processing Script
```python
##  LDAP Utilities: Search - post-processing script ##

#incident.addNote(str(results))
# Processing if the function is a success
if(results.success):
  for entry in results["entries"]:
    
    if entry is None:
      break
    
    else:
      # Add Row
      row = incident.addRow("ldap_computers_query_results")
      
      row['hostname'] = entry['cn'] 
      
      if len(entry['operatingSystemServicePack']) == 0:
        row['os'] = entry['operatingSystem'] + ' ' + entry['operatingSystemVersion'] 
      else:
        row['os'] = entry['operatingSystem'] + ' ' + entry['operatingSystemVersion'] + ' ' + entry['operatingSystemServicePack']
      
      row['when_created'] = entry['whenCreated']
      row['password_last_set'] = entry['pwdLastSet']
      row['dn'] = entry['distinguishedName']

```

---

